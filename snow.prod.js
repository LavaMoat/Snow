(function(){"use strict";(()=>{var e={586:(e,t,n)=>{const r=n(228),{getFramesArray:o,getFrameTag:i}=n(648),{getOnload:c,setOnload:a,removeAttribute:l,addEventListener:u}=n(14);function s(e,t,n){if(!i(t))return;u(t,"load",(function(){r(e,[this],n)}));const o=c(t);o&&(a(t,null),l(t,"onload"),a(t,o))}e.exports=function(e,t,n){for(let r=0;r<t.length;r++){const i=t[r],c=o(i,!0);for(let t=0;t<c.length;t++)s(e,c[t],n)}}},750:e=>{e.exports=function(e){e&&e.contentWindow}},228:(e,t,n)=>{const r=n(851),o=n(750),{shadows:i,getFramesArray:c,getFrameTag:a}=n(648),{getContentWindow:l,Object:u,getFrameElement:s}=n(14);function p(e,t){let n=-1;for(;e[++n];)if(!r(e[n],e,u)&&s(e[n])===t)return e[n];for(let e=0;e<i.length;e++){const n=i[e],r=c(n,!1);for(let e=0;e<r.length;e++)if(r[e]===t)return l(r[e],a(r[e]))}return null}e.exports=function(e,t,n){for(let r=0;r<t.length;r++){const i=t[r];o(i);const c=p(e,i);c&&n(c)}}},328:(e,t,n)=>{const{getFramesArray:r}=n(648),{removeAttribute:o,getAttribute:i,getTemplateContent:c,createElement:a,getInnerHTML:l,setInnerHTML:u}=n(14),{warn:s,WARN_IFRAME_ONLOAD_ATTRIBUTE_REMOVED:p}=n(312);function m(e){for(let t=0;t<e.length;t++){const n=e[t],r=i(n,"onload");r&&(s(p,n,r),o(n,"onload"))}}e.exports=function(e,t){for(let e=0;e<t.length;e++){const n=t[e],o=a(document,"template");u(o,n);const i=r(c(o),!1);i.length&&(m(i),t[e]=l(o))}}},352:(e,t,n)=>{const r=n(228),o=n(583),i=n(459),c=n(58),{hookShadowDOM:a}=n(373),{securely:l,addEventListener:u,getFrameElement:s}=n(14),{isMarked:p,mark:m}=n(111),{error:f,ERR_MARK_NEW_WINDOW_FAILED:d}=n(312);function g(e){try{const t=!p(e);return t&&m(e),t}catch(t){f(d,e,t)}return g(e)}function E(e,t){g(t)&&function(e,t,n,r){o(e,t),i(e,t),c(e,t),a(e,t),r(e,n)}(t,(function(n){E(e,n),u(s(n),"load",(function(){r(t,[this],(function(){E(e,n)}))}))}),l,e)}let y=!1;e.exports=function(e,t){y||(y=!0,E(e,t||window))}},58:(e,t,n)=>{const{protectShadows:r}=n(373),o=n(586),{getFramesArray:i,shadows:c}=n(648),{getParentElement:a,slice:l,Object:u,Function:s}=n(14),p=n(328),m=n(228),f={DocumentFragment:["replaceChildren","append","prepend"],Document:["replaceChildren","append","prepend","write","writeln"],Node:["appendChild","insertBefore","replaceChild"],Element:["innerHTML","outerHTML","insertAdjacentHTML","replaceWith","insertAdjacentElement","append","before","prepend","after","replaceChildren"],ShadowRoot:["innerHTML"],HTMLIFrameElement:["srcdoc"]};function d(e,t,n){return function(){const u=l(arguments),f=a(this)||this;o(e,u,n),o(e,c,n),p(e,u),p(e,c);const d=s.prototype.apply.call(t,this,u),g=i(f,!1);return m(e,g,n),m(e,u,n),r(e,n,!0),d}}e.exports=function(e,t){for(const n in f){const r=f[n];for(let o=0;o<r.length;o++){const i=r[o],c=u.getOwnPropertyDescriptor(e[n].prototype,i),a=c.set?"set":"value";c[a]=d(e,c[a],t),u.defineProperty(e[n].prototype,i,c)}}}},459:(e,t,n)=>{const r=n(228),{removeEventListener:o,addEventListener:i,slice:c,Map:a,Object:l}=n(14),u=new a;function s(e,t,n){if(t)return t.handleEvent?t.handleEvent.apply(t,n):t.apply(e,n)}function p(e,t){return function(n,o,a){let l=o;return"load"===n&&(u.has(o)||u.set(o,(function(){r(e,[this],t);const n=c(arguments);s(this,o,n)})),l=u.get(o)),i(this||e,n,l,a)}}function m(e){return function(t,n,r){let i=n;return"load"===t&&(i=u.get(n),u.delete(n)),o(this||e,t,i,r)}}e.exports=function(e,t){l.defineProperty(e.EventTarget.prototype,"addEventListener",{value:p(e,t)}),l.defineProperty(e.EventTarget.prototype,"removeEventListener",{value:m(e)})}},312:e=>{e.exports={warn:function(e,t,n){let r;switch(e){case 1:const e=t,o=n;r=!1,console.warn("SNOW:","removing html string iframe onload attribute:",e,'"'.concat(o,'"'),".","\n","if this prevents your application from running correctly, please visit/report at","https://github.com/LavaMoat/snow/issues/32#issuecomment-1239273328",".");break;case 3:const i=t,c=n;r=!0,console.warn("SNOW:","blocking open API call:",i,c,".","\n","if this prevents your application from running correctly, please visit/report at","https://github.com/LavaMoat/snow/issues/2#issuecomment-1239264255",".")}return r},error:function(e,t,n){let r;if(2===e){const e=t,o=n;r=!0,console.error("SNOW:","failed to mark new window:",e,".","\n","if this prevents your application from running correctly, please visit/report at","https://github.com/LavaMoat/snow/issues/33#issuecomment-1239280063",".","\n","in order to maintain a bulletproof defense mechanism, failing to mark a new window typically causes an infinite loop",".","\n","error caught:","\n",o)}return r},WARN_IFRAME_ONLOAD_ATTRIBUTE_REMOVED:1,ERR_MARK_NEW_WINDOW_FAILED:2,WARN_OPEN_API_DISABLED:3}},111:(e,t,n)=>{const{Map:r,Object:o,Array:i}=n(14),c=(Math.random()+1).toString(36).substring(7),a=new r;e.exports={isMarked:function(e){if(!a.has(e))return!1;const t=o.getOwnPropertyDescriptor(e,"SNOW_ID");if(!t||!o.hasOwnProperty.call(t,"value"))return!1;if("function"!=typeof t.value)return!1;const n=a.get(e);return t.value(c)===n},mark:function(e){const t=new i;o.defineProperty(e,"SNOW_ID",{configurable:!1,writable:!1,value:e=>e===c&&t}),a.set(e,t)}}},14:e=>{e.exports=function(e){const t=function(e){return function(e,t){const n=e.document.createElement("iframe");e.document.head.appendChild(n);const r=function(e){const{JSON:t,Attr:n,String:r,Function:o,Map:i,Node:c,Document:a,DocumentFragment:l,ShadowRoot:u,Object:s,Array:p,Element:m,HTMLElement:f,HTMLTemplateElement:d,EventTarget:g,HTMLIFrameElement:E,HTMLFrameElement:y,HTMLObjectElement:w}=e,O={JSON:t,Attr:n,String:r,Function:o,Map:i,Node:c,Document:a,DocumentFragment:l,ShadowRoot:u,Object:s,Array:p,Element:m,HTMLElement:f,HTMLTemplateElement:d,EventTarget:g,HTMLIFrameElement:E,HTMLFrameElement:y,HTMLObjectElement:w};return O.document={createElement:e.document.createElement},O}(n.contentWindow);return n.parentElement.removeChild(n),r}(e)}(e),{Function:n,Map:r,Node:o,Document:i,DocumentFragment:c,ShadowRoot:a,Object:l,Array:u,Element:s,HTMLElement:p,HTMLTemplateElement:m,EventTarget:f,HTMLIFrameElement:d,HTMLFrameElement:g,HTMLObjectElement:E}=t;return l.assign(t,{iframeContentWindow:l.getOwnPropertyDescriptor(d.prototype,"contentWindow").get,frameContentWindow:l.getOwnPropertyDescriptor(g.prototype,"contentWindow").get,objectContentWindow:l.getOwnPropertyDescriptor(E.prototype,"contentWindow").get,createElement:l.getOwnPropertyDescriptor(i.prototype,"createElement").value,slice:l.getOwnPropertyDescriptor(u.prototype,"slice").value,nodeType:l.getOwnPropertyDescriptor(o.prototype,"nodeType").get,tagName:l.getOwnPropertyDescriptor(s.prototype,"tagName").get,getInnerHTML:l.getOwnPropertyDescriptor(s.prototype,"innerHTML").get,setInnerHTML:l.getOwnPropertyDescriptor(s.prototype,"innerHTML").set,toString:l.getOwnPropertyDescriptor(l.prototype,"toString").value,getOnload:l.getOwnPropertyDescriptor(p.prototype,"onload").get,setOnload:l.getOwnPropertyDescriptor(p.prototype,"onload").set,getAttribute:l.getOwnPropertyDescriptor(s.prototype,"getAttribute").value,removeAttribute:l.getOwnPropertyDescriptor(s.prototype,"removeAttribute").value,addEventListener:l.getOwnPropertyDescriptor(f.prototype,"addEventListener").value,removeEventListener:l.getOwnPropertyDescriptor(f.prototype,"removeEventListener").value,getTemplateContent:l.getOwnPropertyDescriptor(m.prototype,"content").get,getFrameElement:l.getOwnPropertyDescriptor(e,"frameElement").get,getParentElement:l.getOwnPropertyDescriptor(o.prototype,"parentElement").get}),{Object:l,Function:n,Node:o,Element:s,Document:i,DocumentFragment:c,ShadowRoot:a,Array:u,Map:r,getContentWindow:function(e,n){switch(n){case"IFRAME":return t.iframeContentWindow.call(e);case"FRAME":return t.frameContentWindow.call(e);case"OBJECT":return t.objectContentWindow.call(e);default:return null}},parse:function(e,n){return t.JSON.parse(e,n)},stringify:function(e,n,r){return t.JSON.stringify(e,n,r)},slice:function(e,n,r){return t.slice.call(e,n,r)},nodeType:function(e){return t.nodeType.call(e)},tagName:function(e){return t.tagName.call(e)},toString:function(e){return t.toString.call(e)},getOnload:function(e){return t.getOnload.call(e)},setOnload:function(e,n){return t.setOnload.call(e,n)},removeAttribute:function(e,n){return t.removeAttribute.call(e,n)},getAttribute:function(e,n){return t.getAttribute.call(e,n)},addEventListener:function(e,n,r,o){return t.addEventListener.call(e,n,r,o)},removeEventListener:function(e,n,r,o){return t.removeEventListener.call(e,n,r,o)},createElement:function(e,n,r){return t.createElement.call(e,n,r)},getInnerHTML:function(e){return t.getInnerHTML.call(e)},setInnerHTML:function(e,n){return t.setInnerHTML.call(e,n)},getTemplateContent:function(e){return t.getTemplateContent.call(e)},getFrameElement:function(e){return t.Function.prototype.call.call(t.getFrameElement,e)},getParentElement:function(e){return t.getParentElement.call(e)}}}(top)},583:(e,t,n)=>{const{slice:r,Function:o}=n(14),{warn:i,WARN_OPEN_API_DISABLED:c}=n(312);e.exports=function(e,t){const n=e.open;e.open=function(){const a=r(arguments),l=i(c,a,e);if(l)return null;const u=o.prototype.apply.call(n,this,a);return t(u),u}}},373:(e,t,n)=>{const r=n(228),{getFramesArray:o,shadows:i}=n(648),{Object:c,Function:a}=n(14);function l(e,t,n){for(let c=0;c<i.length;c++){const a=i[c];if(n&&!a.isConnected)continue;const l=o(a,!1);r(e,l,t)}}e.exports={hookShadowDOM:function(e,t){const n=c.getOwnPropertyDescriptor(e.Element.prototype,"attachShadow"),r=n.value;n.value=function(e,t,n){return function(r){const o=a.prototype.call.call(t,this,r);return i.push(o),l(e,n,!0),o}}(e,r,t),c.defineProperty(e.Element.prototype,"attachShadow",n)},protectShadows:l}},648:(e,t,n)=>{const{tagName:r,nodeType:o,slice:i,Array:c,parse:a,stringify:l,Node:u,Document:s,DocumentFragment:p,Element:m,ShadowRoot:f}=n(14),d=new c;function g(e){return d.includes(e)}function E(e,t){let n=!1;for(let r=0;r<t.length;r++)e.includes(t[r])||(e.push(t[r]),n=!0);return n}e.exports={getFramesArray:function(e,t){const n=new c;if(null===e||"object"!=typeof e)return n;if("string"==typeof a(l(r=e,((e,t)=>e||r!==t?"":t)))||!function(e){if(g(e))return!0;const t=o(e);return t===m.prototype.ELEMENT_NODE||t===m.prototype.DOCUMENT_FRAGMENT_NODE||t===m.prototype.DOCUMENT_NODE}(e))return n;var r;const d=function(e){if(g(e))return f;switch(o(e)){case u.prototype.DOCUMENT_NODE:return s;case u.prototype.DOCUMENT_FRAGMENT_NODE:return p;default:return m}}(e).prototype.querySelectorAll,y=d.call(e,"iframe,frame,object,embed");return E(n,i(y)),t&&E(n,[e]),n},getFrameTag:function(e){if(!e||"object"!=typeof e)return null;if(o(e)!==m.prototype.ELEMENT_NODE)return null;if(g(e))return null;const t=r(e);return"IFRAME"!==t&&"FRAME"!==t&&"OBJECT"!==t&&"EMBED"!==t?null:t},shadows:d}},626:e=>{e.exports={SRC_IS_NOT_A_WINDOW:'provided argument "src" must be a proper window of instance Window',DST_IS_NOT_A_WINDOW:'provided argument "dst" must be a proper window of instance Window',SRC_IS_NOT_SAME_ORIGIN_AS_WINDOW:'provided argument "src" must be a window in the same origin as the current context window'}},851:(e,t,n)=>{const{DST_IS_NOT_A_WINDOW:r,SRC_IS_NOT_A_WINDOW:o,SRC_IS_NOT_SAME_ORIGIN_AS_WINDOW:i}=n(626);function c(e,t){const n=t(e);return n===n.window}function a(e,t,n){return null===n.getPrototypeOf.call(t,e)}e.exports=function(e,t=window,n=window.Object){if(!c(t,n))throw new Error(o);if(!c(e,n))throw new Error(r);if(a(window,t,n))throw new Error(i);return a(e,t,n)}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e,t=n(352),r=n.n(t);e=window,Object.defineProperty(e,"SNOW",{value:r()})})()})();}())